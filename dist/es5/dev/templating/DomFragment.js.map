{"version":3,"sources":["../../../es6/dev/templating/DomFragment.js"],"names":[],"mappings":"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","file":"DomFragment.js","sourcesContent":["/**\n * Created by guntars on 22/01/2016.\n */\n(function(root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(factory);\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    }\n}(this, function() {\n    'use strict';\n    function createPlaceholder(tag) {\n        var placeholder = document.createElement(tag || 'div');\n        placeholder.setAttribute('style', 'display:none;');\n        return placeholder;\n    }\n\n    class DomFragment {\n        constructor(_node, placeholder, childNodes, elGroup, index, obj) {\n            Object.assign(this, {\n                _node,\n                placeholder,\n                childNodes,\n                elGroup,\n                index,\n                obj\n            });\n            return this.render();\n        };\n\n        applyAttributes(el) {\n            let attributes = this._node.data.attribs;\n            Object.keys(attributes).forEach(function(key) {\n                el.setAttribute(key, attributes[key]);\n            });\n        };\n\n        applyFragment(el) {\n            let node = this._node;\n            let plFragment = node.template();\n            if (plFragment) {\n                while (plFragment.childNodes.length > 0) {\n                    el.appendChild(plFragment.childNodes[0]);\n                }\n            }\n        };\n\n        appendToBody(el) {\n            let elGroup = this.elGroup,\n                placeholder = this.placeholder,\n                size = elGroup.size;\n\n            if (size > 0) {\n                let index = (this.index === undefined || this.index > size - 1) ? size - 1 : this.index - 1,\n                    target = elGroup.keys()[index !== -1 ? index : 0],\n                    parentNode = target.parentNode;\n\n                if (index === -1) {\n                    parentNode.insertBefore(el, target);\n                }\n                else if (target.nextSibling !== null) {\n                    parentNode.insertBefore(el, target.nextSibling);\n                } else {\n                    parentNode.appendChild(el);\n                }\n\n            } else {\n                let parentNode = placeholder.parentNode;\n                if (parentNode) {\n                    parentNode.replaceChild(el, placeholder);\n                }\n            }\n        };\n\n\n        render() {\n            let placeholder = this.placeholder,\n                node = this._node,\n                keep = (!placeholder.id && this.elGroup.size === 0),\n                instance = node.tmpEl((keep) ? placeholder : false, this.obj, this.childNodes, node),\n                el = instance.el || createPlaceholder(node.data.tag);\n\n            if (!keep && !node.replace) {\n                this.applyAttributes(el);\n            } else if (!node.replace) {\n                el.innerHTML = '';\n            }\n\n            if (!node.replace) {\n                this.applyFragment(el);\n            }\n\n            this.appendToBody(el);\n\n            if (instance.ready) {\n                instance.ready(el);\n            }\n\n            return instance;\n\n        }\n    }\n    return DomFragment;\n}));"]}