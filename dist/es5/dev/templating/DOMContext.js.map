{"version":3,"sources":["../../../es6/dev/templating/DOMContext.js"],"names":[],"mappings":"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","file":"DOMContext.js","sourcesContent":["/**\n * Created by guntars on 22/01/2016.\n */\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(factory);\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory();\n    }\n}(this, function () {\n    'use strict';\n    function applyAttr(dataset, subKeys, attrib) {\n        let attr = (subKeys.length > 2) ? {[subKeys[2]]: attrib} : attrib;\n        if (subKeys.length > 2) {\n            dataset[subKeys[1]] = dataset[subKeys[1]] || {};\n            Object.assign(dataset[subKeys[1]], attr);\n        } else {\n            dataset[subKeys[1]] = attr\n        }\n    }\n\n    function setDataFromAttributes(attributes) {\n        //TODO: rename dataset tu camel case\n        var dataset = {},\n            tplSet = {},\n            attribs = {};\n\n        Object.keys(attributes).forEach((key) => {\n            let subKeys = key.split('-'),\n                attrib = attributes[key];\n            if (['data', 'tp'].indexOf(subKeys[0]) !== -1 && subKeys.length > 1) {\n\n                if (subKeys[0] === 'data') {\n                    applyAttr(dataset, subKeys, attrib)\n                } else {\n                    applyAttr(tplSet, subKeys, attrib)\n                }\n            } else {\n                attribs[key] = attrib;\n            }\n        });\n        return {\n            dataset, tplSet, attribs\n        }\n\n    }\n\n    return function DOMContext(compiler, element) {\n        var domParser = compiler._domParser,\n            data = setDataFromAttributes(element.attribs);\n        data.name = element.name.split('-')[1] || data.tplSet.name;\n        data.type = data.tplSet.type || element.name.split('-')[0];\n\n\n        return {\n            setTag(coderName){\n                data.tag = (element.name.split('-')[0] !== coderName) ? element.name : data.tplSet.tag || 'div';\n            },\n            outerTemplate(){\n                var children = domParser.getChildren(element),\n                    holder = domParser.createElement(data.tag);\n\n                if (children && children.length > 0) {\n                    children.forEach((child)=> {\n                        domParser.appendChild(holder, child);\n                    });\n                }\n                return domParser.getOuterHTML(holder);\n            },\n            setPlaceholder(id, noTag){\n                if (noTag) {\n                    domParser.removeElement(element);\n                } else {\n                    var placeholder = domParser.createElement(data.tag);\n                    domParser.setAttributeValue(placeholder, 'id', id);\n                    domParser.setAttributeValue(placeholder, 'style', 'display:none');\n                    domParser.replaceElement(element, placeholder);\n                }\n            },\n            getInnerHTML(){\n                return domParser.getInnerHTML(element)\n            },\n            getChildrenElements () {\n                return domParser.getChildrenElements(element);\n            },\n            removeChildren () {\n                var children = element.children;\n                if (children.length > 0) {\n                    children.forEach(function (child) {\n                        domParser.removeElement(child);\n                    }.bind(this));\n                }\n            },\n            get type() {\n                return data.type;\n            },\n            get tag() {\n                return data.tag;\n            },\n            get templateId() {\n                return compiler.templateId;\n            },\n            get url() {\n                return compiler.url;\n            },\n            get data() {\n                return data;\n            },\n            getAttributeValue(name) {\n                return domParser.getAttributeValue(element, name);\n            },\n            setAttributeValue(name, value) {\n                return domParser.setAttributeValue(element, name, value);\n            }\n        };\n    }\n}));"]}