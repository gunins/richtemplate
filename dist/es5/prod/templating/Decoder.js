/*! richtemplate 2016-03-25 */
"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();define("templating/utils/List",[],function(){var a=function(){function a(b){_classCallCheck(this,a),this._map=new Map(b),this._indexes=[].concat(_toConsumableArray(this._map.keys())),this._onDelete=[]}return _createClass(a,[{key:"keys",value:function(){return this._indexes}},{key:"values",value:function(){return this.entries().map(function(a){return a[1]})}},{key:"entries",value:function(){var a=this;return this._indexes.map(function(b){return[b,a._map.get(b)]})}},{key:"get",value:function(a){return this._map.get(a)}},{key:"forEach",value:function(a){return this.values().forEach(function(b,c){for(var d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];return a.apply(null,[b,c].concat(e))})}},{key:"getIndex",value:function(a){return this._indexes.indexOf(a)}},{key:"changeIndex",value:function(a,b){if(a){var c=this._indexes,d=c.indexOf(a);-1!==d&&b!==d&&this._indexes.splice(b,0,this._indexes.splice(d,1)[0])}}},{key:"getValueByIndex",value:function(a){return this._map.get(this._indexes[a])}},{key:"getKeyByIndex",value:function(a){return this._indexes[a]}},{key:"set",value:function(a,b,c){this._map.set(a,b),void 0!==c?this._indexes.splice(c,0,a):this._indexes.push(a)}},{key:"has",value:function(a){return this._map.has(a)}},{key:"clear",value:function(){this._map.clear(),this._indexes.splice(0,this._indexes.length)}},{key:"onDelete",value:function(a){var b=function(){return a.apply(void 0,arguments)};return this._onDelete.push(b),{remove:function(){this._onDelete.splice(this._onDelete.indexOf(b,1))}}}},{key:"delete",value:function(a){var b=this;this.has(a)&&!function(){var c=b._map.get(a);b._map["delete"](a),b._indexes.splice(b._indexes.indexOf(a),1),b._onDelete.forEach(function(d){return d(a,b.size,c)})}()}},{key:"deleteByIndex",value:function(a){this["delete"](this._indexes[a])}},{key:"first",get:function(){return this.getValueByIndex(0)}},{key:"last",get:function(){return this.getValueByIndex(this._indexes.length-1)}},{key:"size",get:function(){return this._map.size}}]),a}();return a}),define("templating/dom",[],function(){function a(a){var b="undefined"==typeof a?"undefined":_typeof(a);return"function"===b||"object"===b&&!!a}function b(a){var b=document.createElement(a||"div");return b.setAttribute("style","display:none;"),b}function c(a){var b=Object.keys(a);b.length>0&&b.forEach(function(b){if("root"!==b){var c=a[b];void 0!==c.elGroup&&c.elGroup.size>0&&c.elGroup.forEach(function(a){void 0!==a&&void 0!==a.remove&&a.remove(!0)})}})}var d=function(){function a(b,c){_classCallCheck(this,a),this.el=b,this._events=[],this.name=c.name||c.data.name;var d=this.data=c.data;d&&d.bind&&(this.bind=d.bind)}return _createClass(a,[{key:"clone",value:function(){return this.run.apply(this,arguments)}},{key:"text",value:function(a){e.text(this,a)}},{key:"detach",value:function(){e.detach(this)}},{key:"attach",value:function(){e.attach(this)}},{key:"changePosition",value:function(a){e.changePosition(this,a)}},{key:"setAttribute",value:function(a,b){e.setAttribute(this,a,b)}},{key:"getAttribute",value:function(a){return e.getAttribute(this,a)}},{key:"removeAttribute",value:function(a){e.removeAttribute(this,a)}},{key:"setStyle",value:function(a,b){e.setStyle(this,a,b)}},{key:"getStyle",value:function(a){return e.getStyle(this,a)}},{key:"removeStyle",value:function(a){e.removeStyle(this,a)}},{key:"addClass",value:function(a){e.addClass(this,a)}},{key:"hasClass",value:function(a){return e.hasClass(this,a)}},{key:"removeClass",value:function(a){e.removeClass(this,a)}},{key:"val",value:function(a){return e.val(this,a)}},{key:"on",value:function(a,b,c){var d=Array.prototype.slice.call(arguments,0);return e.on.apply(!1,[this].concat(d))}},{key:"onDOMAttached",value:function(){return e.onDOMAttached(this)}},{key:"remove",value:function(a){e.remove(this,a)}}]),a}(),e={detach:function(a){a.placeholder instanceof HTMLElement==!1&&(a.placeholder=b(a.data.tag||a.el.tagName)),a&&a.el&&a.el.parentNode&&a.el.parentNode.replaceChild(a.placeholder,a.el)},attach:function(a){a&&a.el&&a.placeholder&&a.placeholder.parentNode&&a.placeholder.parentNode.replaceChild(a.el,a.placeholder)},append:function(a,b){void 0!==a.el&&void 0!==b.el&&a.el.appendChild(b.el)},prepend:function(a,b){e.insertBefore(a,b,0)},insertBefore:function(a,b,c){var d=a.el,e=b.el;void 0!==d&&void 0!==e&&(void 0!==d.childNodes[c]?d.insertBefore(e,d.childNodes[c]):d.appendChild(e))},changePosition:function(a,b){var c=a.el;if(c&&c.parentNode){var d=c.parentNode,e=a.elGroup,f=e.size,g=e.getKeyByIndex(b)||e.getLast();g!==c&&(f-1>=b?d.insertBefore(c,g):null!==g.nextSibling?d.insertBefore(c,g.nextSibling):d.appendChild(c),a.elGroup.changeIndex(c,b))}},text:function(a,b){a&&a.el&&(a.el.innerHTML=b)},setAttribute:function(b,c,d){b&&b.el&&(a(c)?Object.keys(c).forEach(function(a){b.el.setAttribute(a,c[a])}):b.el.setAttribute(c,d))},getAttribute:function(a,b){return a&&a.el?a.el.getAttribute(b):void 0},removeAttribute:function(a,b){a&&a.el&&a.el.removeAttribute(b)},setStyle:function(b,c,d){b&&b.el&&(a(c)?Object.keys(c).forEach(function(a){b.el.style[a]=c[a]}):b.el.style[c]=d)},getStyle:function(a,b){return a&&a.el&&void 0!==a.el&&void 0!==a.el.style?a.el.style[b]:void 0},removeStyle:function(a,b){a&&a.el&&(a.el.style[b]="")},addClass:function(a,b){a&&a.el&&a.el.classList.add(b)},hasClass:function(a,b){return a&&a.el?a.el.classList.contains(b):!1},removeClass:function(a,b){a&&a.el&&a.el.classList.remove(b)},val:function(a,b){if(a&&a.el){var c=a.el;if(void 0===b)return c.value;c.value=b}},on:function(a,b,c,d){for(var e=arguments.length,f=Array(e>4?e-4:0),g=4;e>g;g++)f[g-4]=arguments[g];var h=this,i=a.el,j=b.split(" "),k=function(b){c.apply(d||h,[b,a].concat(f))};j.forEach(function(a){i.addEventListener(a,k)});var l={remove:function(){j.forEach(function(a){return i.removeEventListener(a,k)});var b=a._events;b.splice(b.indexOf(l),1)}};return a._events.push(l),l},remove:function(a){for(;a._events.length>0;)a._events.shift().remove();a.children&&c(a.children),void 0!==a.elGroup&&a.elGroup["delete"](a.el),void 0!==a.el&&(a.el.remove?a.el.remove():a.el.parentNode&&a.el.parentNode.removeChild(a.el),delete a.el)},onDOMAttached:function(a){var b=this,c=[],d=!1,e=void 0;return void 0!==a.el&&(e=function(){if(d)for(;c.length>0;)c.shift()();else window.requestAnimationFrame(e),document.body.contains(a.el)&&(d=!0)}),{then:function(a,d){c.push(a.bind(d||b)),window.requestAnimationFrame(e)}}},Element:d};return e}),function(a,b){"function"==typeof define&&define.amd?define("templating/DomFragment",b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b())}(void 0,function(){var a=function(){function a(b,c,d,e,f,g){return _classCallCheck(this,a),Object.assign(this,{_node:b,placeholder:c,childNodes:d,elGroup:e,index:f,obj:g}),this.render()}return _createClass(a,[{key:"applyAttributes",value:function(a){var b=this._node.data.attribs;Object.keys(b).forEach(function(c){a.setAttribute(c,b[c])})}},{key:"applyFragment",value:function(a){var b=this._node,c=b.template();if(void 0!==c)for(;c.childNodes.length>0;)a.appendChild(c.childNodes[0])}},{key:"appendToBody",value:function(a){var b=this.elGroup,c=this.placeholder,d=b.size;if(d>0){var e=void 0===this.index||this.index>d-1?d-1:this.index-1,f=b.keys()[-1!==e?e:0],g=f.parentNode;-1===e?g.insertBefore(a,f):null!==f.nextSibling?g.insertBefore(a,f.nextSibling):g.appendChild(a)}else{var h=c.parentNode;h&&h.replaceChild(a,c)}}},{key:"render",value:function(){var a=this.placeholder,b=this._node,c=!a.id&&0===this.elGroup.size,d=b.tmpEl(c?a:!1,this.obj,this.childNodes,b),e=d.el;return c||b.replace?b.replace||(e.innerHTML=""):this.applyAttributes(e),b.replace||this.applyFragment(e),this.appendToBody(e),d}}]),a}();return a}),function(a,b){"function"==typeof define&&define.amd?define("templating/Decoder",["./utils/List","./dom","./DomFragment"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b(require("./utils/List"),require("./dom"),require("./DomFragment")))}(void 0,function(a,b,c){function d(a){return a===Object(a)}function e(a){return Array.isArray?Array.isArray(a):"[object Array]"===toString.call(a)}var f={},g=function(){function g(a){_classCallCheck(this,g),this._root="string"==typeof a?JSON.parse(a):a,a.children&&a.children.length>0&&(this.children=this._parseElements(a.children))}return _createClass(g,null,[{key:"addDecoder",value:function(a){void 0===f[a.tagName]&&(f[a.tagName]=a)}}]),_createClass(g,[{key:"renderFragment",value:function(a){var b=document.createElement("template");return b.innerHTML=a,void 0!==b.content?b.content.firstChild:b.firstChild}},{key:"_parseElements",value:function(a){var b=this,c={};return a.forEach(function(a){var d=a.data.name,e=a.tagName;if(e){var g=f[e].decode(a);if(g){var h={name:g.name,data:g.data,tmpEl:g.tmpEl,parse:g.parse,replace:g.replace,id:a.id,template:function(){return b.renderFragment(a.template,a.data.tag)},noAttach:f[e].noAttach||a.data.tplSet.noattach};a.children&&a.children.length>0&&(h.children=b._parseElements(a.children)),c[d]=h}}else d&&(c[d]={id:a.id,data:a.data,name:d})}),c}},{key:"renderTemplate",value:function(){var f=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],g=this,h=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments[2],j={},k=[];Object.keys(f).forEach(function(l){var m=f[l],n=m.children,o=new a,p=document.createElement(m.data.tplSet.tag||"div");if(p.setAttribute("style","display:none;"),p.id=m.id,o.onDelete(function(a,b){0===b&&a.parentNode&&(a.parentNode.replaceChild(p,a),i=function(){return p})}),m.template)!function(){var a=function b(a,f){var j=i();a instanceof HTMLElement==!0&&(j=a);var k=void 0,l=j!==a&&(d(a)||e(a))?a:h;if(!m.noAttach||a){var p=j.querySelector("#"+m.id)||j;n&&(k=g.renderTemplate(n,l,function(){return j}));var q=new c(m,p,k,o,f,l);return j=q.el,k&&k.runAll&&m.parse&&k.runAll(),k&&!q.children&&(q.children=k),q.elGroup=o,q.run=b,o.set(q.el,q,f),q}};k.push(a),j[l]={data:m.data,run:a,elGroup:o}}();else{var q=new b.Element(i().querySelector("#"+m.id),m);q.removeAttribute("id"),q.elGroup=o,o.set(q.el,q),j[l]=q}});var l=function(a,b,c){Object.defineProperty(a,b,{enumerable:!1,value:c})},m=function(a){return k.forEach(function(b){return b(a)}),j};return l(j,"runAll",m),j}},{key:"render",value:function(a){var b=this.renderFragment(this._root.template);return{fragment:b,children:this.renderTemplate(this.children,a,function(){return b}).runAll(),templateId:this._root.templateId}}}]),g}();return g}),function(a,b){"function"==typeof define&&define.amd?define("coders/component/cpDecoder",["templating/Decoder"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b(require("./Decoder")))}(void 0,function(a){var b={tagName:"cp",decode:function(a){var b=a.data,c={name:b.name,replace:!0,tmpEl:function(a,c,d,e){var f=new b.src(b.dataset,d,c,e);return f},data:b||{}};return void 0!==b.dataset.bind&&(c.bind=b.dataset.bind),c}};return a&&a.addDecoder(b),b}),function(a,b){"function"==typeof define&&define.amd?define("coders/placeholders/plDecoder",["templating/Decoder","templating/dom"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b(require("./Decoder"),require("./dom")))}(void 0,function(a,b){var c={tagName:"pl",decode:function(a){var c=a.data;return{name:c.name,tmpEl:function(a,d,e,f){return new b.Element(a||document.createElement(c.tag),f)},parse:!0,data:c}}};return a&&a.addDecoder(c),c}),function(a,b){"function"==typeof define&&define.amd?define("coders/databind/bdDecoder",["templating/Decoder","templating/dom"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b(require("./Decoder"),require("./dom")))}(void 0,function(a,b){var c={tagName:"bd",noAttach:!0,decode:function(a){var c=this.data=a.data,d={name:c.name,tmpEl:function(a,d,e,f){return new b.Element(a||document.createElement(c.tag),f)},data:c};return d}};return a&&a.addDecoder(c),c}),function(a,b){"function"==typeof define&&define.amd?define("coders/router/routerDecoder",["templating/Decoder","templating/dom"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b(require("./Decoder"),require("./dom")))}(void 0,function(a,b){var c={tagName:"rt",noAttach:!0,decode:function(a){var c=a.data,d={name:c.name,tmpEl:function(a,d,e,f){return new b.Element(a||document.createElement(c.tag),f)},parse:!0,data:c||{}};return d}};return a&&a.addDecoder(c),c}),function(a,b){"function"==typeof define&&define.amd?define("coders/style/styleDecoder",["templating/Decoder"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&(module.exports=b(require("./Decoder")))}(void 0,function(a){var b={tagName:"style",decode:function(a){if(void 0===a.data.styleAttached){a.data.styleAttached=!0;var b=document.createElement("style");b.innerHTML=a.data.style,document.head.appendChild(b)}}};return a&&a.addDecoder(b),b});